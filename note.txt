lockbox/lockbox/
â”œâ”€â”€ app/          â† On garde (Ã©crans)
â”œâ”€â”€ assets/       â† On garde (images)
â”œâ”€â”€ src/          â† Notre code (que tu as crÃ©Ã©)
â”œâ”€â”€ node_modules/ â† On garde (dÃ©pendances)
â”œâ”€â”€ package.json  â† On garde
â””â”€â”€ ...

fichier lockbox/
â”œâ”€ app/
â”‚  â”œâ”€ lock.tsx
â”‚  â”œâ”€ index.tsx
â”‚  â”œâ”€ import.tsx
â”‚  â”œâ”€ view.tsx
â”‚  â”œâ”€ settings.tsx
â”œâ”€ src/
â”‚  â”œâ”€ types.ts
â”‚  â”œâ”€ db.ts
â”‚  â”œâ”€ crypto.ts
â”‚  â”œâ”€ auth.ts
â”‚  â”œâ”€ files.ts


fichie : 
----------------------------- Types.ts ------------------------------

MIME : le type du contenu (ex: application/pdf, image/png) â€” utile pour choisir le viewer.
URI : â€œadresseâ€ dâ€™un fichier/app resource sur lâ€™appareil (ex: file:///...).
Hash du PIN : on ne stocke pas le PIN, mais son hash (ex: SHA-256) dans SecureStore.
Nonce / IV : valeur alÃ©atoire et unique par chiffrement. Avec AEAD (XChaCha20-Poly1305 / AES-GCM), câ€™est indispensable pour la sÃ©curitÃ©. On la stocke avec les mÃ©tadonnÃ©es pour pouvoir dÃ©chiffrer.
category? : champ optionnel (pas obligÃ© de le renseigner).

ðŸ“‹ RÃ©sumÃ© ultra-rapide de src/types.ts

DocumentEntry : Un document en DB (id, title, filename chiffrÃ©, mime, nonce, catÃ©gorie, date, taille)
CreateDocumentParams : ParamÃ¨tres pour crÃ©er un nouveau document en DB
AuthConfig : Config sÃ©curitÃ© (hash PIN, biomÃ©trie on/off, dÃ©lai auto-lock)
EncryptionResult : RÃ©sultat de chiffrement (data chiffrÃ©e + nonce)
ImportResult : RÃ©sultat d'import (success, documentId, error Ã©ventuelle)
FileToImport : Info fichier Ã  importer (uri, nom, mime, taille)
DecryptionResult : Fichier dÃ©chiffrÃ© temporaire (uri temp + mime)
BackupData : Structure d'export (version, timestamp, entries, fichiers en base64)
AppLockState : Ã‰tat de l'app (locked | unlocked | first-launch)
DOCUMENT_CATEGORIES : Liste des catÃ©gories (Personnel, Travail, MÃ©dical, Financier, Juridique, Autre)


------------------------ db.ts ---------------------------------------
!!!!!!
db = clÃ© USB (branchÃ©e ou non).
initDatabase() = tu la branches.
ensureDbInitialized() = tu vÃ©rifies quâ€™elle est branchÃ©e avant de lire/Ã©crire.
closeDatabase() = tu lâ€™Ã©jectes proprement avant dâ€™Ã©teindre ton ordi.

FONCTION 
initDatabase() â†’ crÃ©e/ouvre la base SQLite et la table entries si absente.

checkDb() â†’ vÃ©rifie que la base est bien initialisÃ©e avant utilisation.

insertDocument() â†’ ajoute un nouveau document dans la table.

getAllDocuments() â†’ rÃ©cupÃ¨re tous les documents triÃ©s par date.

getDocumentById() â†’ obtient un document spÃ©cifique via son ID.

getDocumentsByCategory() â†’ liste les documents dâ€™une catÃ©gorie donnÃ©e.

updateDocumentTitle() â†’ modifie le titre dâ€™un document existant.

updateDocumentCategory() â†’ modifie ou supprime la catÃ©gorie dâ€™un document.

deleteDocument() â†’ supprime un document par ID.

searchDocuments() â†’ cherche des documents par mot-clÃ© dans le titre.

getDocumentCount() â†’ retourne le nombre total de documents stockÃ©s.

clearDatabase() â†’ vide complÃ¨tement la table des documents.

closeDatabase() â†’ ferme proprement la connexion Ã  la base.




--------------------------crypto.ts-------------------------------------
GÃ¨re tout ce qui touche au chiffrement et Ã  la clÃ© secrÃ¨te dans de l'appli.
DONC : transforme des fichiers â€œnormauxâ€ â†’ en donnÃ©es illisibles, puis il permet de les dÃ©chiffrer plus tard avec la bonne clÃ©.

initCrypto() : Initialise la librairie libsodium(le moteur de chiffrement utilisÃ©). 
â†’ retourne : rien (void)

ensureMasterKey() : GÃ©nÃ¨re ou rÃ©cupÃ¨re la clÃ© maÃ®tre (32 bytes, SecureStore)
â†’ retourne : la clÃ© maÃ®tre (Uint8Array)


encryptData() : Chiffre des donnÃ©es â†’ renvoie { encryptedData, nonce }   ( nonce â†’ une valeur alÃ©atoire utilisÃ©e une fois pour ce chiffrement prÃ©cis, pas secret et stoket dans un fichier )
                                                                         ( encryptedData â†’ les donnÃ©es chiffrÃ©es (illisibles))
â†’ retourne : un objet { encryptedData: Uint8Array, nonce: string }
AEAD = Authenticated Encryption with Associated Data 
â†’ Chiffre les donnÃ©es ET vÃ©rifie leur intÃ©gritÃ©. 
â†’ Si quelquâ€™un modifie le fichier chiffrÃ© 
â†’ le dÃ©chiffrement Ã©choue. 
â†’ UtilisÃ© dans LockBox via XChaCha20-Poly1305 (libsodium).

decryptData(encryptedData, nonce) : DÃ©chiffre les donnÃ©es grÃ¢ce Ã  la clÃ© et au nonce -> fichier original
â†’ retourne : les donnÃ©es dÃ©chiffrÃ©es (Uint8Array ou texte original)

clearMasterKeyCache() : Efface la clÃ© de la mÃ©moire RAM quand lâ€™app se verrouille
â†’ retourne : rien (void)

deleteMasterKey() : Supprime dÃ©finitivement la clÃ© (reset total) -> tout les fichier dÃ©finitivement illisibles
â†’ retourne : rien (void)

hasMasterKey() : VÃ©rifie si une clÃ© maÃ®tre existe dÃ©jÃ  (si elle est dans ke SecureStore)  -> true ou false
â†’ retourne : un boolÃ©en (boolean)

generateEncryptedFilename() : CrÃ©e un nom de fichier alÃ©atoire f_<id>.enc
â†’ retourne : une chaÃ®ne (string)

hashPassword() : Calcule le hash SHA-256 dâ€™un PIN
                On ne stocke jamais un mot de passe ni un PIN en clair.
                Au lieu de Ã§a, on stocke le hash :
                SHA256("1234") = "03ac674216f3e15c761ee1a5e255f067..."
â†’ retourne : le hash (string)

verifyPassword(pin, hash) : Compare un PIN saisi Ã  son hash enregistrÃ©
hash("1234") === pinHash ? OK : refusÃ©
â†’ retourne : true si le PIN est correct, false sinon


------------------------------- auth.ts ----------------------





---------------------------------- files.ts------------------
initFileSystem() â†’ CrÃ©e les dossiers encrypted/ et temp/ au dÃ©marrage

readFileAsBytes() â†’ Lit un fichier et le convertit en Uint8Array (bytes)

writeBytesToFile() â†’ Ã‰crit des bytes (Uint8Array) dans un fichier

encryptAndSaveFile() â†’ Chiffre un fichier et le sauvegarde dans encrypted/ â†’ retourne (filename, nonce, size)

decryptToTempFile() â†’ DÃ©chiffre un fichier et le sauvegarde temporairement dans temp/ â†’ retourne (tempUri, mimeType)

deleteEncryptedFile() â†’ Supprime un fichier chiffrÃ© du dossier encrypted/

deleteTempFile() â†’ Supprime un fichier temporaire du cache

cleanTempFiles() â†’ Nettoie tous les fichiers temporaires (appelÃ© au dÃ©marrage/verrouillage)

getEncryptedFileSize() â†’ RÃ©cupÃ¨re la taille d'un fichier chiffrÃ© en bytes

encryptedFileExists() â†’ VÃ©rifie si un fichier chiffrÃ© existe dans encrypted/

listEncryptedFiles() â†’ Liste tous les fichiers dans le dossier encrypted/ (debug)

getExtensionFromMimeType() â†’ Convertit un type MIME en extension (.pdf, .jpg, etc.)

formatFileSize() â†’ Convertit une taille en bytes vers format lisible (Ko, Mo, Go)